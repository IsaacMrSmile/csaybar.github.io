gsub('[^[:alnum:][:blank:]?/\\:]','',"Hidrog: \u0091La Sulf trigonoc\u0092")
gsub('[^[:alnum:][:blank:]?/\\:]','',"Hidrog: \u0091La Sulf trigonoc\u0092")
str_remove_all("Hidrog: \u0091La Sulf trigonoc\u0092",'[^[:alnum:][:blank:]?/\\:]')
library(stringr)
library(dplyr)
gsub('[^[:alnum:][:blank:]?/\\:]','',"Hidrog: \u0091La Sulf trigonoc\u0092")
str_remove_all("Hidrog: \u0091La Sulf trigonoc\u0092",'[^[:alnum:][:blank:]?/\\:]')
library(sf)
dist = read_sf('/home/aybarpc01/Downloads/drive-download-20181108T231042Z-001/dist_02.shp')
dist$IDDIST
dist = read_sf('/home/aybarpc01/Downloads/Limite_distrital/Limite_distrital/BAS_LIM_DISTRITOS.shp')
dist_02 = read_sf('/home/aybarpc01/Downloads/drive-download-20181108T231042Z-001/dist_02.shp')
dist$IDDIST
dist$IDDIST[1:10]
dist_02$IDDIST[1:10]
variables = c('IDDIST','sum')
dist_02[variables]
dist_02[[variables]]
library(tidyverse)
df = data_frame(IDDIST = dist_02$IDDIST,pixels = dist_02$sum)
df
st_area(dist_02)
dist_02
st_area(dist_02)
area = st_area(dist_02)
ddf = df %>% mutate(pixels = (pixels*100/area))
ddf$pixels
plot(ddf$pixels)
pixels
ddf = df %>% mutate(pixels = (pixels*10000/area))
plot(ddf$pixels)
ddf = df %>% mutate(pixels = (pixels*10000/area))
plot(ddf$pixels)
dist_02 = read_sf('/home/aybarpc01/Downloads/drive-download-20181108T231042Z-001/dist_02.shp')
colnames(dist_02)
dist_02[c(3,area_2)]
dist_02[c(3,'area_2')]
dist_02[c('IDDIST','area_2')]
dist_02 = dist_02[c('IDDIST','area_2')]
colnames(dist_02) = c('IDDIST','flood_area')
colnames(dist_02)
dist_02
colnames(dist_02) = c('IDDIST','flood_area','geometry')
dist_02
dist[c(2,5)]
data_frame(dist[c(2,5)])
dist[c(2,5)] %>% as_tibble()
dist[c(2,5)] %>% as_tibble() %>% '['(1:2)
dasdas = dist[c(2,5)]
dasdas[1:2]
dsasdadsad = data_frame(dasdas$IDDIST,dasdas$NOMBDIST)
dsasdadsad
dist_02
dddddd = dist_02 %>% arrange()
dddddd
dddddd = dist_02 %>% arrange('IDDIST')
dddddd = dist_02 %>% arrange(IDDIST)
dsasdadsad = data_frame(dasdas$IDDIST,dasdas$NOMBDIST)%>% arrange(IDDIST)
dsasdadsad = data_frame(IDDIST = dasdas$IDDIST,NOMBDIST= dasdas$NOMBDIST) %>% arrange(IDDIST)
dddddd = dist_02 %>% arrange(IDDIST)
dddddd
dddddd$IDDIST
dddddd$IDDIST[1:10]
dsasdadsad$IDDIST[1:10]
dddddd
dddddd$name_dist = dsasdadsad$NOMBDIST
dddddd
write_sf(dddddd,"/home/aybarpc01/distritos/district.shp")
library(raster)
raster('/home/aybarpc01/Downloads/PR_1950-01-01.tif')
dd = brick('/home/aybarpc01/Downloads/PR_1950-01-01.tif')
mean(dd)
dddd = mean(dd)
dddd
dd
dd[[!]]
dd[[1]]
dd[[1]]*1
plot(dd[[1]]*1)
dd = brick('/home/aybarpc01/Downloads/4cca535dd4c13a3ab4bd7ad95d6b074c/PR_1950-01-01 (1).tif')
dd
dddd = mean(dd)
dddd
plot(dddd)
plot(dddd*365)
dd[100]
as.numeric(dd[100])
plot(as.numeric(dd[100]))
plot(as.numeric(dd[100]),type="l")
library(raster)
dd = brick('/home/aybarpc01/Downloads/tasminhistorical1952-01-01.tif')
dd
mean(dd)
plot(mean(dd))
library(raster)
dd = brick('/home/aybarpc01/Downloads/NorESM1-Mtasminrcp452008-01-01.tif')
plot(mean(dd))
dd
dddd = sum(stack(list.files('/home/aybarpc01/Downloads/drive-download-20181115T181546Z-001/',full.names = T)))
list.files('/home/aybarpc01/Downloads/drive-download-20181115T181546Z-001/',full.names = T)
stack(list.files('/home/aybarpc01/Downloads/drive-download-20181115T181546Z-001/',full.names = T))
library(raster)
dddd = sum(stack(list.files('/home/aybarpc01/Downloads/drive-download-20181115T181546Z-001/',full.names = T)))
writeRaster(dddd,'/home/aybarpc01/Downloads/drive-download-20181115T085745Z-001/sum2.tif')
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF (2)/splib07a_Wavelengths_ASD_0.35-2.5_microns_2151_ch.txt')
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF (2)/splib07a_Wavelengths_ASD_0.35-2.5_microns_2151_ch.txt')
rtable
rtable$V1
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF (2)/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sss/bandpass.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sss/sss.txt')
plot(rtable$V1)
rtable
rtable
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sss/ddddd.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sss/xxxx.txt')
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sss/xxxx.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/svs/dsdasdasd.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/svs/sfsfdgd.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/svs/dasdasdasdasd.txt')
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/svs/dasdasdasdasd.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/svs/dsd.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/svs/splib07a_Conifer-Meadow-Mix_YNP-CM-1_AVIRISb_RTGC.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sts/splib07a_Alunite-K_CU91-217G1_HiTemp_ASDFRb_AREF.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/VIC_run/servir-vic-training-master/scripts/drive-download-20181117T044616Z-001/sss/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF (2)/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF (2)/splib07a_Melting_snow_mSnw01a_ASDFRa_AREF.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Aspen_Aspen-1_green-top_ASDFRa_AREF/splib07a_Bandpass_(FWHM)_ASDFR_StandardResolution.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Aspen_Aspen-1_green-top_ASDFRa_AREF/splib07a_Aspen_Aspen-1_green-top_ASDFRa_AREF.txt')
plot(rtable$V1)
rtable = read.table('/home/aybarpc01/Downloads/splib07a_Aspen_Aspen-1_green-top_ASDFRa_AREF/splib07a_Aspen_Aspen-1_green-top_ASDFRa_AREF.txt')
plot(rtable$V1)
rtable[rtable>1000]=0
plot(rtable$V1)
rtable
plot(rtable$V1)
rtable[rtable<0]=0
plot(rtable$V1)
library(sp)
library(raster)
knitr::opts_chunk$set(echo = TRUE)
library('raster')
library('gdalUtils')
library('rasterVis')
library('sf')
library('mapview')
library('future')
library('purrr') # ex girlfriend
library('furrr') # new girlfriend
library('tidyverse')
user <- 'publi_dgh2' # ftp user
pass <- '123456'   # ftp user
ftp <- 'ftp.senamhi.gob.pe/PISCOp_V2.1_beta/' # url
dir <- 'PISCOp_climatology/PISCOp_climatology/' # urn
months <- sprintf('%02d',1:12) # GEOtiff names
clim <- sprintf('ftp://%s:%s@%s%s%s.tif', user, pass, ftp, dir,months)
ftp_n <- mapply(download.file, clim,basename(clim),quiet = TRUE)
clim_stack <- stack(basename(clim)) %>%
'names<-'(month.abb) # change the RasterLayer names
cols <- brewer.pal(11, "RdBu") #palette
range <- seq(-1, 800, 100) # Precipitation range
levelplot(clim_stack, par.settings=GrTheme(),at=range)
# Creating a polygon of the PISCOp extent
piscop_extent <- clim_stack[[1]] %>%
extent %>%
raster(nrows=1,ncols=1) %>%
as('SpatialPolygons') %>%
st_as_sf()
piscop_extent$NOMBRE = 'PISCOp extent'
arequipa <- st_read('arequipa_simply.shp', quiet = TRUE)
m_01 <- mapview(arequipa)
m_02 <- mapview(piscop_extent, fill=NA)
m_01 + m_02
raster_base <- crop(clim_stack[[1]], arequipa)
res(raster_base) <- 0.05
system.time(
clim_1_a <- resample(clim_stack,raster_base,method='bilinear')
)
plot(clim_1_a[[1]], main = 'Jan Precipitation in Arequipa')
plot(as(arequipa,'Spatial'),add=T)
#' Resampling a Raster* object via GDAL
#'
#' @param r Raster* object to be resampled
#' @param r_base Raster* object with parameters that r
#' should be resampled to.
#' @param method Character. GDAL resampling_method
#' ("near"|"bilinear"|"cubic"|"cubicspline"|
#'  "lanczos"|"average"|"mode"|"max"|"min"|
#'  "med"|"q1"|"q3")
#'
#' @export
gdal_resample <- function(r,r_base,method='bilinear') {
#Geometry attributes
t1 <- c(xmin(r_base), ymin(r_base),
xmax(r_base), ymax(r_base))
res <- res(r_base)
#Temporal files
tmp_outname <- sprintf('%s.tif',tempfile())
tmp_inname <- sprintf('%s.tif',tempfile())
writeRaster(r,tmp_inname)
#GDAL time!
gdalwarp(tmp_inname,tmp_outname,tr=res,te=t1,r = method)
resample_raster = raster(tmp_outname)
mapply(file.remove,c(tmp_inname,tmp_outname))
return(resample_raster)
}
system.time(
clim_1_b <- names(clim_stack) %>%
map(~ gdal_resample(clim_stack[[.x]],raster_base)) %>%
stack()
)
plot(clim_1_a[[1]], main = 'Jan Precipitation in Arequipa')
plot(as(arequipa,'Spatial'),add=T)
message(sprintf('%s \n',system('lscpu',intern = T)))
raster_base
plan(multiprocess)
system.time(
clim_1_b <- names(clim_stack) %>%
future_map(~ gdal_resample(clim_stack[[.x]],raster_base)) %>%
stack()
)
plan
plan
multiprocess
library(blogdown)
serve_site()
hugo_server()
library(blogdown)
hugo_server()
setwd("/home/aybarpc01/Github/csaybar.github.io/")
hugo_server()
hugo_build(local = FALSE)
blogdown::serve_site()
